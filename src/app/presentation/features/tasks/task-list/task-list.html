<div class="page-container">
    <mat-toolbar color="white">
        <span>My Tasks</span>
        <span class="spacer"></span>
        <span class="user-email">{{ currentUser()?.email }}</span>
        <button mat-icon-button (click)="onLogout()" aria-label="Logout">
            <mat-icon>logout</mat-icon>
        </button>
    </mat-toolbar>

    <div class="content">

        <mat-card class="add-task-card">
            <mat-card-header>
                <mat-card-title>New Task</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <form [formGroup]="taskForm" (ngSubmit)="onAddTask()">
                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>What needs to be done?</mat-label>
                        <input matInput formControlName="title" placeholder="Buy groceries" required>
                        <mat-error *ngIf="taskForm.get('title')?.hasError('required')">Title is required</mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Description (Optional)</mat-label>
                        <textarea matInput formControlName="description" placeholder="Details..."></textarea>
                    </mat-form-field>

                    <div class="form-actions">
                        <button mat-raised-button color="primary" type="submit" [disabled]="taskForm.invalid">
                            <mat-icon>add</mat-icon> Add Task
                        </button>
                    </div>
                </form>
            </mat-card-content>
        </mat-card>

        <div class="task-list">
            <div *ngIf="tasks().length === 0" class="empty-state">
                <mat-icon>assignment_turned_in</mat-icon>
                <h3>No tasks yet</h3>
                <p>Your task list is empty. Add a task above to get started.</p>
            </div>

            <app-task-item *ngFor="let task of tasks()" [task]="task" (toggle)="onToggle(task)" (edit)="onEdit(task)"
                (delete)="onDelete(task)">
            </app-task-item>
        </div>
    </div>
</div>